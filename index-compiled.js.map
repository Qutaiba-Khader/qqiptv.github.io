{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;AAIA;;AAEA,IAAI,KAAK,QAAQ,IAAR,CAAL;;AAEJ,IAAI,OAAO,QAAQ,MAAR,CAAP;AACJ,IAAI,WAAW,QAAQ,KAAR,EAAe,KAAf;;AAEf,MAAM,IAAN,CAAU;;;;;;;;;;;AAWN,gBAAY,OAAZ,EAAoB;AAChB,YAAI,MAAM,OAAN,CAAc,OAAd,CAAJ,EAA2B;AACvB,sBAAU,EAAC,SAAS,OAAT,EAAX,CADuB;SAA3B;;AAIA,aAAK,OAAL,GAAe,OAAf,CALgB;KAApB;;;;;;;;;;;;;;;AAXM,iBAgCN,CAAc,OAAd,EAAuB,QAAvB,EAAgC,EAAhC;;;;;;AAhCM,WAwCN,GAAS,EAAT;;;;;;AAxCM,aAgDN,GAAW,EAAX;;AAIA,WAAO,SAAP,CAAiB,IAAjB,EAAsB;AAClB,eAAO,IAAI,OAAJ,CACH,UAAS,OAAT,EAAkB,MAAlB,EAA0B;AACtB,eAAG,QAAH,CAAY,IAAZ,EAAkB,MAAlB,EAA0B,CAAC,GAAD,EAAM,IAAN,KAAe;AACrC,oBAAI,GAAJ,EAAS;AACL,2BAAO,GAAP,EADK;iBAAT,MAGK;AACD,4BAAQ,IAAR,EADC;iBAHL;aADsB,CAA1B,CADsB;SAA1B,CADJ,CADkB;KAAtB;;AAcA,WAAO,UAAP,CAAkB,GAAlB,EAAsB;AAClB,eAAO,IAAI,OAAJ,CACH,UAAS,OAAT,EAAkB,MAAlB,EAAyB;AACrB,gBAAI,MAAM,KAAK,GAAL,CAAS,SAAS,GAAT,CAAT,EAAwB,UAAU,GAAV,EAAe;AAC7C,oBAAI,IAAI,UAAJ,KAAmB,GAAnB,EAAwB;AACxB,2BAAO,IAAI,KAAJ,CAAU,2BAAyB,IAAI,UAAJ,CAA1C,EADwB;AAExB,2BAFwB;iBAA5B;;AAKA,oBAAI,OAAO,EAAP,CANyC;;AAQ7C,oBAAI,EAAJ,CAAO,MAAP,EAAe,UAAU,KAAV,EAAiB;AAC5B,4BAAQ,KAAR,CAD4B;iBAAjB,CAAf,CAR6C;AAW7C,oBAAI,EAAJ,CAAO,KAAP,EAAc,YAAY;AACtB,4BAAQ,IAAR,EADsB;iBAAZ,CAAd,CAX6C;aAAf,CAA9B,CADiB;;AAiBrB,gBAAI,EAAJ,CAAO,OAAP,EAAgB,UAAU,CAAV,EAAa;AACzB,uBAAO,CAAP,EADyB;aAAb,CAAhB,CAjBqB;AAoBrB,gBAAI,GAAJ,GApBqB;SAAzB,CADJ,CADkB;KAAtB;;AA2BA,WAAO,UAAP,CAAkB,GAAlB,EAAsB;AAClB,YAAI,IAAI,UAAJ,CAAe,SAAf,KAA2B,IAAI,UAAJ,CAAe,SAAf,CAA3B,EAAqD;AACrD,mBAAO,WAAW,GAAX,CAAP,CADqD;SAAzD;;AAIA,eAAO,UAAU,GAAV,CAAP,CALkB;KAAtB;CA7FJ;;AAsGA,OAAO,OAAP,GAAiB,IAAjB","file":"index-compiled.js","sourcesContent":["/**\n * Created by solvek on 08.02.16.\n */\n\n\"use strict\";\n\nvar fs = require('fs');\n\nvar http = require(\"http\");\nvar urlParse = require(\"url\").parse;\n\nclass Pled{\n    /**\n     * @param {Object|string[]} options Pled options object or array of sources\n     * @param {string[]} options.sources Sources of m3u files. Each source is either a path\n     * to local file of a url to an http file (starting from \"http://\" or \"https://\")\n     * @param {FilterFunction[]} [options.filters] Sequence of filters\n     * @param {string} [options.cachePath] Path to cache file\n     * @param {int} [options.cacheTime=5*24*60*60*1000] Time for cache in milliseconds. By default 5 days\n     * @param {boolean} [options.forceReload] If cache file is specified this parameter allows\n     * to not use the cache but regenerate content (however resulting content still can be saved to the cache)\n     */\n    constructor(options){\n        if (Array.isArray(options)){\n            options = {sources: options};\n        }\n\n        this.options = options;\n    }\n\n    /**\n     * @name FilterFunction\n     * @function\n     * @param {Object} stream Stream object\n     * @param {string} [source] Source\n     * @param {Object[]} [collected] Already collected streams for result\n     * @return Either modified Stream Object of undefined. Undefined means that the stream should not be outputted in result.\n     */\n\n    /**\n     * It is possible to use Pled in pair with [Express.js]{@link http://expressjs.com/}. Handles HTTP request.\n     * See `samples` directory for an example.\n     */\n    handleRequest(request, response){\n\n    }\n\n    /**\n     * Processes play list sources and generates resulting playlist as string\n     * @returns Promise with a string value - content of m3u\n     */\n    execute(){\n\n    }\n\n    /**\n     * Loads playlist from cache file.\n     * If the cache file does not exists or it is to old (@see option.cacheTime) this methods fails\n     */\n    loadCache(){\n\n    }\n\n    static loadLocal(path){\n        return new Promise(\n            function(resolve, reject) {\n                fs.readFile(path, 'utf8', (err, data) => {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve(data);\n                    }\n                });\n            });\n    }\n\n    static loadRemote(url){\n        return new Promise(\n            function(resolve, reject){\n                var req = http.get(urlParse(url), function (res) {\n                    if (res.statusCode !== 200) {\n                        reject(new Error(\"Http returned status: \"+req.statusCode));\n                        return;\n                    }\n\n                    var data = '';\n\n                    res.on('data', function (chunk) {\n                        data += chunk;\n                    });\n                    res.on('end', function () {\n                        resolve(data);\n                    });\n                });\n\n                req.on('error', function (e) {\n                    reject(e);\n                });\n                req.end();\n            }\n        );\n    }\n\n    static loadSource(url){\n        if (url.startsWith('http://')||url.startsWith('http://')){\n            return loadRemote(url);\n        }\n\n        return loadLocal(url);\n    }\n}\n\nmodule.exports = Pled;"]}